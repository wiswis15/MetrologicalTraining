set(TVCONTROL_TEST_CLIENT_ARTIFACT
    TVControlTestClient
    )

include(setup_target_properties_executable)
include(show_target_properties)

message("Setting up ${TVCONTROL_TEST_CLIENT_ARTIFACT}")


if (CLION_ENVIRONMENT)
    set(WPEFRAMEWORK_INCLUDE_DIRS ${WPEFRAMEWORK_ROOT}/Source)
endif ()

set(TVCONTROL_TEST_CLIENT_DEFINITIONS
    )

set(TVCONTROL_TEST_CLIENT_INCLUDE_DIRS
    ${WPEFRAMEWORK_INCLUDE_DIRS})

set(TVCONTROL_TEST_CLIENT_OPTIONS
    )

set(TVCONTROL_TEST_CLIENT_LINK_OPTIONS
    )

set(TVCONTROL_TEST_CLIENT_DEPENDENCIES
    )

set(TVCONTROL_TEST_CLIENT_LIBS
    ${CMAKE_THREAD_LIBS_INIT}
    ${CMAKE_DL_LIBS}
    WPEFrameworkCore
    WPEFrameworkPlugins
    WPEFrameworkProtocols
    ${TVCONTROL_TEST_CLIENT_DEPENDENCIES}
    )

file(GLOB TVCONTROL_TEST_CLIENT_INCLUDES *.h
    )

set(TVCONTROL_TEST_CLIENT_SOURCES
    TVControlTestClient.cpp
    )

set(TVCONTROL_TEST_CLIENT_INPUT
    ${TVCONTROL_TEST_CLIENT_SOURCES}
    ${TVCONTROL_TEST_CLIENT_INCLUDES}
    )

display_list("Defines                     : " ${TVCONTROL_TEST_CLIENT_DEFINITIONS})
display_list("Compiler options            : " ${TVCONTROL_TEST_CLIENT_OPTIONS})
display_list("Source files                : " ${TVCONTROL_TEST_CLIENT_SOURCES})
display_list("Include files               : " ${TVCONTROL_TEST_CLIENT_INCLUDES})
display_list("Include dirs                : " ${TVCONTROL_TEST_CLIENT_INCLUDE_DIRS})
display_list("Link libs                   : " ${TVCONTROL_TEST_CLIENT_LIBS})
display_list("Linker options              : " ${TVCONTROL_TEST_CLIENT_LINK_OPTIONS})
display_list("Dependencies                : " ${TVCONTROL_TEST_CLIENT_DEPENDENCIES})

add_executable(${TVCONTROL_TEST_CLIENT_ARTIFACT} ${TVCONTROL_TEST_CLIENT_INPUT})
target_compile_definitions(${TVCONTROL_TEST_CLIENT_ARTIFACT} PRIVATE ${TVCONTROL_TEST_CLIENT_DEFINITIONS})
target_include_directories(${TVCONTROL_TEST_CLIENT_ARTIFACT} PRIVATE ${TVCONTROL_TEST_CLIENT_INCLUDE_DIRS})
target_link_libraries(${TVCONTROL_TEST_CLIENT_ARTIFACT} ${TVCONTROL_TEST_CLIENT_LIBS})
list_to_string(TVCONTROL_TEST_CLIENT_LINK_OPTIONS TVCONTROL_TEST_CLIENT_LINK_OPTIONS_STRING)
if (NOT "${TVCONTROL_TEST_CLIENT_LINK_OPTIONS_STRING}" STREQUAL "")
    set_target_properties(${TVCONTROL_TEST_CLIENT_ARTIFACT} PROPERTIES LINK_FLAGS "${TVCONTROL_TEST_CLIENT_LINK_OPTIONS_STRING}")
endif ()
set_target_properties(${TVCONTROL_TEST_CLIENT_ARTIFACT} PROPERTIES OUTPUT_NAME ${TVCONTROL_TEST_CLIENT_ARTIFACT})

setup_target_properties_executable(${TVCONTROL_TEST_CLIENT_ARTIFACT})

show_target_properties(${TVCONTROL_TEST_CLIENT_ARTIFACT})

# uninstall target
configure_file(
    ${WPEFRAMEWORK_PLUGINS_ROOT}/cmake/uninstall.cmake.in
    ${CMAKE_CURRENT_BINARY_DIR}/uninstall.cmake
    IMMEDIATE @ONLY)

add_custom_target(uninstall_${TVCONTROL_TEST_CLIENT_ARTIFACT}
    COMMAND ${CMAKE_COMMAND} -DCOMPONENT=${TVCONTROL_TEST_CLIENT_ARTIFACT} -P ${CMAKE_CURRENT_BINARY_DIR}/uninstall.cmake
    DEPENDS ${TVCONTROL_TEST_CLIENT_ARTIFACT}
    COMMENT "Uninstalling ${TVCONTROL_TEST_CLIENT_ARTIFACT}")

add_custom_target(install_${TVCONTROL_TEST_CLIENT_ARTIFACT}
    COMMAND ${CMAKE_COMMAND} -DCOMPONENT=${TVCONTROL_TEST_CLIENT_ARTIFACT} -P ${CMAKE_BINARY_DIR}/cmake_install.cmake
    DEPENDS ${TVCONTROL_TEST_CLIENT_ARTIFACT}
    COMMENT "Installing ${TVCONTROL_TEST_CLIENT_ARTIFACT}")

add_dependencies(install-component-${COMPONENT_NAME} install_${TVCONTROL_TEST_CLIENT_ARTIFACT})

add_dependencies(uninstall-component-${COMPONENT_NAME} uninstall_${TVCONTROL_TEST_CLIENT_ARTIFACT})

install(
    TARGETS ${TVCONTROL_TEST_CLIENT_ARTIFACT}
    DESTINATION ${CMAKE_INSTALL_PREFIX}/bin
    COMPONENT ${TVCONTROL_TEST_CLIENT_ARTIFACT})
